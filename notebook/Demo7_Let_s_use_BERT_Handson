{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"Handson_Let's_use_BERT","provenance":[{"file_id":"https://github.com/ydaigo/BERT_HANDSON/blob/master/BERT_HANDS_ON.ipynb","timestamp":1588920983965}],"collapsed_sections":[]},"kernelspec":{"name":"python3","display_name":"Python 3"},"widgets":{"application/vnd.jupyter.widget-state+json":{"57430c56fab7411baafa1b6307dc4d84":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_288d9358674d4379acbff7e67147a520","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_7521a87253d64791903c9b89d5f04872","IPY_MODEL_79aa097e43b64c51a8f6607d28b9d978"]}},"288d9358674d4379acbff7e67147a520":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"7521a87253d64791903c9b89d5f04872":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_27b64c5c05e1467baebf84cf27c330dc","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":257706,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":257706,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_a212701487724a248d38f71493308a75"}},"79aa097e43b64c51a8f6607d28b9d978":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_6978969786bd4849814a11eaf46973d4","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 258k/258k [00:02&lt;00:00, 110kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_423e2b50c0464e418d626a2528d4f5a1"}},"27b64c5c05e1467baebf84cf27c330dc":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"a212701487724a248d38f71493308a75":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"6978969786bd4849814a11eaf46973d4":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"423e2b50c0464e418d626a2528d4f5a1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"5b1471b19d8b40669775afb21d1eef0d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_e0ea8f9e210d429596a9aeae5ee57f38","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_ff50f2d913704bcc9598066a81235c39","IPY_MODEL_cfe5a2cb60c546a7a7648a638eb1bd01"]}},"e0ea8f9e210d429596a9aeae5ee57f38":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ff50f2d913704bcc9598066a81235c39":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_d7c7cdf58fef4baa8124359223cae4da","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":112,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":112,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_dfbb07819859406cb2e95190c6f6ec91"}},"cfe5a2cb60c546a7a7648a638eb1bd01":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_2f44373a84de424eb4ef60be1e6df125","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 112/112 [00:00&lt;00:00, 141B/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_782a46154b414eedb52198333a38c690"}},"d7c7cdf58fef4baa8124359223cae4da":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"dfbb07819859406cb2e95190c6f6ec91":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2f44373a84de424eb4ef60be1e6df125":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"782a46154b414eedb52198333a38c690":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e6ab2b2762484a8e8ba75324283c2bf4":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_89b0ba1a5f474a329b83fa45f25025a4","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_4f8e2d2f5637457abd330b5f88bcb256","IPY_MODEL_c44ade2594804b53a1ab3dfb323ac8c0"]}},"89b0ba1a5f474a329b83fa45f25025a4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"4f8e2d2f5637457abd330b5f88bcb256":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_7e2217cca4f6478fa884acb68644d4c7","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":111,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":111,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_8e4664d73d1041a18421a7be5b521277"}},"c44ade2594804b53a1ab3dfb323ac8c0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_9e5c4e3d214a4608ad6b2ef23199e24b","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 111/111 [00:00&lt;00:00, 253B/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_d5a59a3aa1d84157a1b5970e85587bba"}},"7e2217cca4f6478fa884acb68644d4c7":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"8e4664d73d1041a18421a7be5b521277":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"9e5c4e3d214a4608ad6b2ef23199e24b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"d5a59a3aa1d84157a1b5970e85587bba":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d9f2121bfa764125a70409d80dd3a93f":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_d63f08075f00424fac073f620b547bd7","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_f15ceba5f8de4f248895d99e79f8747a","IPY_MODEL_35a8fa9a61304ba78e9407b3c4235b71"]}},"d63f08075f00424fac073f620b547bd7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f15ceba5f8de4f248895d99e79f8747a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_7e80f3df53fe4cdabd1dc869ff428a92","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":1271,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1271,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_9a7f0193b8f840a6991bbf1c4d61677d"}},"35a8fa9a61304ba78e9407b3c4235b71":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_3e77529cb6d0416da2828715cfbb9d85","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1.27k/1.27k [00:01&lt;00:00, 666B/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_d0347037bb0c4987921ec0896b8e23ed"}},"7e80f3df53fe4cdabd1dc869ff428a92":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"9a7f0193b8f840a6991bbf1c4d61677d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"3e77529cb6d0416da2828715cfbb9d85":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"d0347037bb0c4987921ec0896b8e23ed":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"647ea42ca6ef46e2b7661ccce86b5704":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_e5fc6a284fad43fcbbea8626da7a0862","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_781cbd860bb14df091cfa52b47711bf4","IPY_MODEL_9bb2633cc4da45d2aceb5e5d6e090130"]}},"e5fc6a284fad43fcbbea8626da7a0862":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"781cbd860bb14df091cfa52b47711bf4":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_437d50ea4719411d8a23a0ca3502d514","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":442523795,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":442523795,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_e5bf508f942c4f98a9ee4545e8f376f0"}},"9bb2633cc4da45d2aceb5e5d6e090130":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_ba41a8c59f264995b94f1aab83cb7cde","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 443M/443M [00:08&lt;00:00, 49.4MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_1e1a74c8b3ef4a009aaed5f06906bf06"}},"437d50ea4719411d8a23a0ca3502d514":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"e5bf508f942c4f98a9ee4545e8f376f0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ba41a8c59f264995b94f1aab83cb7cde":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"1e1a74c8b3ef4a009aaed5f06906bf06":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"389495e494ee4a09953e95f8acbf84b4":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_35ddbd3388bb438a8b64e20e2c70b0b2","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_2947647d5fa149f5933f4b3d77d6e117","IPY_MODEL_62d9a547830a4453bfb2386f989b568b"]}},"35ddbd3388bb438a8b64e20e2c70b0b2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2947647d5fa149f5933f4b3d77d6e117":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_5a86ac71b20f40a08fcfc3705eac469f","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":1343,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1343,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_d6a4f72e063244ff818b73216a4930bf"}},"62d9a547830a4453bfb2386f989b568b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_9e9b5c03461c4f28ae48c091e7f2ec39","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1.34k/1.34k [00:01&lt;00:00, 1.19kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_07a1c206185a4f069070d039953ed7cc"}},"5a86ac71b20f40a08fcfc3705eac469f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"d6a4f72e063244ff818b73216a4930bf":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"9e9b5c03461c4f28ae48c091e7f2ec39":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"07a1c206185a4f069070d039953ed7cc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b6e2c254e3ce4e51b38df803af9e7116":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_f7e4bfaa4b954daf8059d1834ce32bf7","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_8ea869038caf4852b374aa2765f055fd","IPY_MODEL_317e7c1df5d244c79fede70d2497fef3"]}},"f7e4bfaa4b954daf8059d1834ce32bf7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8ea869038caf4852b374aa2765f055fd":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_1ec95f6bf172476c8673085bdea8677e","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":898823,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":898823,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_1a49dccaa6df449ab9f0459f5f53a7ec"}},"317e7c1df5d244c79fede70d2497fef3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_1f4eb931ce564cee830d7f279f54d2fe","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 899k/899k [00:01&lt;00:00, 517kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_62fd16ced62a4d56af40c7e10027379e"}},"1ec95f6bf172476c8673085bdea8677e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"1a49dccaa6df449ab9f0459f5f53a7ec":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"1f4eb931ce564cee830d7f279f54d2fe":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"62fd16ced62a4d56af40c7e10027379e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"df7a481584cb4f0fa0cc5017576624ed":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_41610bc3fbe647b48ac4ea17c2c375c9","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_ee06f7f066b34b1493d491ab7fa2f77d","IPY_MODEL_7084b3c2b85b464eb1940967c0f3b1f2"]}},"41610bc3fbe647b48ac4ea17c2c375c9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ee06f7f066b34b1493d491ab7fa2f77d":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_ea8ee6b15159420992658b0bb018b6ff","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":456318,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":456318,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_2e2e4bfaf433478898ac1cccd58c9381"}},"7084b3c2b85b464eb1940967c0f3b1f2":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_650dd97d910d4000a80edd875883aacf","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 456k/456k [00:00&lt;00:00, 895kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_f44aedcf2b2f4e598e27ee329af0452a"}},"ea8ee6b15159420992658b0bb018b6ff":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"2e2e4bfaf433478898ac1cccd58c9381":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"650dd97d910d4000a80edd875883aacf":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"f44aedcf2b2f4e598e27ee329af0452a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"0e890bf4932342a38a4e1844394c5268":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_4f7777619be84e47a53d521e29a4c2cd","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_a9f9ffe1d4464cbf972617b1f0d734ed","IPY_MODEL_b54271936c80419d88f178b4cf115593"]}},"4f7777619be84e47a53d521e29a4c2cd":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a9f9ffe1d4464cbf972617b1f0d734ed":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_e4d6814f79084a689b96af79780c1fa3","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":1625270765,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1625270765,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_0d94b23f062f4633b24a0f9a5e2460e4"}},"b54271936c80419d88f178b4cf115593":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_c9ae004e0fe14865a4ee1e9f8a1dad04","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1.63G/1.63G [00:31&lt;00:00, 51.5MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_a39fc240458142d78decb9494a71bbd6"}},"e4d6814f79084a689b96af79780c1fa3":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"0d94b23f062f4633b24a0f9a5e2460e4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"c9ae004e0fe14865a4ee1e9f8a1dad04":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"a39fc240458142d78decb9494a71bbd6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"markdown","metadata":{"id":"Q4WKR2LrDp9c","colab_type":"text"},"source":["# **BERT**簡易ハンズオン\n","### ～今、NLP界隈で熱い！BERTに触れてみる～\n","\n","<font size=-1>**BERT**(**B**idirectional **E**ncoder **R**epresentations from **T**ransformers：トランスフォーマーによる双方向のエンコード表現)\n","\n","BERTは、Googleが2018年10月に発表した自然言語処理(NLP)モデルで、略称の一部にもある[Transformer](https://scontent-itm1-1.xx.fbcdn.net/v/t31.0-8/s960x960/23117087_783917685113391_4777910378115406214_o.jpg?_nc_cat=111&_nc_sid=8024bb&_nc_ohc=AyIzXlIqzKAAX_jhHWA&_nc_ht=scontent-itm1-1.xx&_nc_tp=7&oh=e93af8553fb69966a386afd4d4939cd3&oe=5EE36A19)をベースとしている。「自然言語処理でもとうとう人間を超える精度を叩き出した」とまで言われるほど大きな話題にもなった。NLP界隈では「2019年はBERTとTransformerの年だった」とも言われており、近年のNLPの動向もBERTが中心となっている。\n","\n","<font size=-1>（BERTに関する解説例は、一先ずこちらの[AINOW記事](https://ainow.ai/2019/05/21/167211/)をご参照。その他はBERTで検索してください。）\n","\n","<font size=-1>（読みは、バート。バイディレクショナル・エンコーダー・リプレゼンテーション・フロム・トランスフォーマー）"]},{"cell_type":"markdown","metadata":{"id":"pEs72tngocHR","colab_type":"text"},"source":["**BERTの特長**\n","\n","BERTは、自然言語処理タスクを**教師なし**でかつ双方向に事前学習する画期的なモデル。<b><font size=-1>\n","（教師なしデータでモデル作成できるため、普通のテキストコーパスのみを用いた訓練が可能。即ち、Web上の莫大な 普通のテキストデータが利用できることが重要なポイント）</b>\n","\n","更に、モデルの**応用**ができる点もポイント。\n","\n","*   <b><font size=-1>事前学習：pre-trainingにかなりのコストがかかる(Cloud TPUで4日～30日など)が、多くの事前学習済みモデルが予めリリースされており、それを使えば良い。\n","*   <b><font size=-1>転移学習：Fine-tuningは低コストで処理でき、Cloud TPUで1時間、GPUならば2時間程度で終わる。\n"]},{"cell_type":"markdown","metadata":{"id":"JjFfNfy8IHvx","colab_type":"text"},"source":["## BERTの準備"]},{"cell_type":"code","metadata":{"id":"U3LfNzvnQM09","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"status":"ok","timestamp":1598420175309,"user_tz":-540,"elapsed":25398,"user":{"displayName":"Takeshi Yanagimoto","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiR4MKhXgeH9jEFGCkO4J8eljwD3IuSWpo5X3QE=s64","userId":"03972123812053985591"}},"outputId":"4f191612-30fd-4fa3-86af-2cc9fe618201"},"source":["!pip install transformers     # Transformersのインストール\n","#!pip install mecab-python3    # MeCabのインストール（最新はうまくいかなくなったので以下で暫定対処）\n","!pip install mecab-python3==0.996.5  #MeCabインストール（旧版）\n","!pip install googletrans      # googletransインストール（後で使う）\n","import torch                  # パッケージのインポート\n","from transformers import pipeline,AutoTokenizer,BertTokenizer,AutoModelForSequenceClassification,BertJapaneseTokenizer, BertForMaskedLM  # パッケージのインポート"],"execution_count":1,"outputs":[{"output_type":"stream","text":["Collecting transformers\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/27/3c/91ed8f5c4e7ef3227b4119200fc0ed4b4fd965b1f0172021c25701087825/transformers-3.0.2-py3-none-any.whl (769kB)\n","\r\u001b[K     |▍                               | 10kB 12.1MB/s eta 0:00:01\r\u001b[K     |▉                               | 20kB 5.8MB/s eta 0:00:01\r\u001b[K     |█▎                              | 30kB 6.7MB/s eta 0:00:01\r\u001b[K     |█▊                              | 40kB 6.7MB/s eta 0:00:01\r\u001b[K     |██▏                             | 51kB 6.4MB/s eta 0:00:01\r\u001b[K     |██▋                             | 61kB 6.9MB/s eta 0:00:01\r\u001b[K     |███                             | 71kB 7.4MB/s eta 0:00:01\r\u001b[K     |███▍                            | 81kB 8.2MB/s eta 0:00:01\r\u001b[K     |███▉                            | 92kB 8.4MB/s eta 0:00:01\r\u001b[K     |████▎                           | 102kB 8.4MB/s eta 0:00:01\r\u001b[K     |████▊                           | 112kB 8.4MB/s eta 0:00:01\r\u001b[K     |█████▏                          | 122kB 8.4MB/s eta 0:00:01\r\u001b[K     |█████▌                          | 133kB 8.4MB/s eta 0:00:01\r\u001b[K     |██████                          | 143kB 8.4MB/s eta 0:00:01\r\u001b[K     |██████▍                         | 153kB 8.4MB/s eta 0:00:01\r\u001b[K     |██████▉                         | 163kB 8.4MB/s eta 0:00:01\r\u001b[K     |███████▎                        | 174kB 8.4MB/s eta 0:00:01\r\u001b[K     |███████▊                        | 184kB 8.4MB/s eta 0:00:01\r\u001b[K     |████████                        | 194kB 8.4MB/s eta 0:00:01\r\u001b[K     |████████▌                       | 204kB 8.4MB/s eta 0:00:01\r\u001b[K     |█████████                       | 215kB 8.4MB/s eta 0:00:01\r\u001b[K     |█████████▍                      | 225kB 8.4MB/s eta 0:00:01\r\u001b[K     |█████████▉                      | 235kB 8.4MB/s eta 0:00:01\r\u001b[K     |██████████▎                     | 245kB 8.4MB/s eta 0:00:01\r\u001b[K     |██████████▋                     | 256kB 8.4MB/s eta 0:00:01\r\u001b[K     |███████████                     | 266kB 8.4MB/s eta 0:00:01\r\u001b[K     |███████████▌                    | 276kB 8.4MB/s eta 0:00:01\r\u001b[K     |████████████                    | 286kB 8.4MB/s eta 0:00:01\r\u001b[K     |████████████▍                   | 296kB 8.4MB/s eta 0:00:01\r\u001b[K     |████████████▉                   | 307kB 8.4MB/s eta 0:00:01\r\u001b[K     |█████████████▏                  | 317kB 8.4MB/s eta 0:00:01\r\u001b[K     |█████████████▋                  | 327kB 8.4MB/s eta 0:00:01\r\u001b[K     |██████████████                  | 337kB 8.4MB/s eta 0:00:01\r\u001b[K     |██████████████▌                 | 348kB 8.4MB/s eta 0:00:01\r\u001b[K     |███████████████                 | 358kB 8.4MB/s eta 0:00:01\r\u001b[K     |███████████████▍                | 368kB 8.4MB/s eta 0:00:01\r\u001b[K     |███████████████▊                | 378kB 8.4MB/s eta 0:00:01\r\u001b[K     |████████████████▏               | 389kB 8.4MB/s eta 0:00:01\r\u001b[K     |████████████████▋               | 399kB 8.4MB/s eta 0:00:01\r\u001b[K     |█████████████████               | 409kB 8.4MB/s eta 0:00:01\r\u001b[K     |█████████████████▌              | 419kB 8.4MB/s eta 0:00:01\r\u001b[K     |██████████████████              | 430kB 8.4MB/s eta 0:00:01\r\u001b[K     |██████████████████▎             | 440kB 8.4MB/s eta 0:00:01\r\u001b[K     |██████████████████▊             | 450kB 8.4MB/s eta 0:00:01\r\u001b[K     |███████████████████▏            | 460kB 8.4MB/s eta 0:00:01\r\u001b[K     |███████████████████▋            | 471kB 8.4MB/s eta 0:00:01\r\u001b[K     |████████████████████            | 481kB 8.4MB/s eta 0:00:01\r\u001b[K     |████████████████████▌           | 491kB 8.4MB/s eta 0:00:01\r\u001b[K     |████████████████████▉           | 501kB 8.4MB/s eta 0:00:01\r\u001b[K     |█████████████████████▎          | 512kB 8.4MB/s eta 0:00:01\r\u001b[K     |█████████████████████▊          | 522kB 8.4MB/s eta 0:00:01\r\u001b[K     |██████████████████████▏         | 532kB 8.4MB/s eta 0:00:01\r\u001b[K     |██████████████████████▋         | 542kB 8.4MB/s eta 0:00:01\r\u001b[K     |███████████████████████         | 552kB 8.4MB/s eta 0:00:01\r\u001b[K     |███████████████████████▍        | 563kB 8.4MB/s eta 0:00:01\r\u001b[K     |███████████████████████▉        | 573kB 8.4MB/s eta 0:00:01\r\u001b[K     |████████████████████████▎       | 583kB 8.4MB/s eta 0:00:01\r\u001b[K     |████████████████████████▊       | 593kB 8.4MB/s eta 0:00:01\r\u001b[K     |█████████████████████████▏      | 604kB 8.4MB/s eta 0:00:01\r\u001b[K     |█████████████████████████▋      | 614kB 8.4MB/s eta 0:00:01\r\u001b[K     |██████████████████████████      | 624kB 8.4MB/s eta 0:00:01\r\u001b[K     |██████████████████████████▍     | 634kB 8.4MB/s eta 0:00:01\r\u001b[K     |██████████████████████████▉     | 645kB 8.4MB/s eta 0:00:01\r\u001b[K     |███████████████████████████▎    | 655kB 8.4MB/s eta 0:00:01\r\u001b[K     |███████████████████████████▊    | 665kB 8.4MB/s eta 0:00:01\r\u001b[K     |████████████████████████████▏   | 675kB 8.4MB/s eta 0:00:01\r\u001b[K     |████████████████████████████▌   | 686kB 8.4MB/s eta 0:00:01\r\u001b[K     |█████████████████████████████   | 696kB 8.4MB/s eta 0:00:01\r\u001b[K     |█████████████████████████████▍  | 706kB 8.4MB/s eta 0:00:01\r\u001b[K     |█████████████████████████████▉  | 716kB 8.4MB/s eta 0:00:01\r\u001b[K     |██████████████████████████████▎ | 727kB 8.4MB/s eta 0:00:01\r\u001b[K     |██████████████████████████████▊ | 737kB 8.4MB/s eta 0:00:01\r\u001b[K     |███████████████████████████████ | 747kB 8.4MB/s eta 0:00:01\r\u001b[K     |███████████████████████████████▌| 757kB 8.4MB/s eta 0:00:01\r\u001b[K     |████████████████████████████████| 768kB 8.4MB/s eta 0:00:01\r\u001b[K     |████████████████████████████████| 778kB 8.4MB/s \n","\u001b[?25hRequirement already satisfied: packaging in /usr/local/lib/python3.6/dist-packages (from transformers) (20.4)\n","Collecting sentencepiece!=0.1.92\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/d4/a4/d0a884c4300004a78cca907a6ff9a5e9fe4f090f5d95ab341c53d28cbc58/sentencepiece-0.1.91-cp36-cp36m-manylinux1_x86_64.whl (1.1MB)\n","\u001b[K     |████████████████████████████████| 1.1MB 27.7MB/s \n","\u001b[?25hRequirement already satisfied: dataclasses; python_version < \"3.7\" in /usr/local/lib/python3.6/dist-packages (from transformers) (0.7)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.6/dist-packages (from transformers) (4.41.1)\n","Requirement already satisfied: requests in /usr/local/lib/python3.6/dist-packages (from transformers) (2.23.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.6/dist-packages (from transformers) (2019.12.20)\n","Collecting tokenizers==0.8.1.rc1\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/40/d0/30d5f8d221a0ed981a186c8eb986ce1c94e3a6e87f994eae9f4aa5250217/tokenizers-0.8.1rc1-cp36-cp36m-manylinux1_x86_64.whl (3.0MB)\n","\u001b[K     |████████████████████████████████| 3.0MB 55.7MB/s \n","\u001b[?25hCollecting sacremoses\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/7d/34/09d19aff26edcc8eb2a01bed8e98f13a1537005d31e95233fd48216eed10/sacremoses-0.0.43.tar.gz (883kB)\n","\u001b[K     |████████████████████████████████| 890kB 39.7MB/s \n","\u001b[?25hRequirement already satisfied: numpy in /usr/local/lib/python3.6/dist-packages (from transformers) (1.18.5)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.6/dist-packages (from transformers) (3.0.12)\n","Requirement already satisfied: pyparsing>=2.0.2 in /usr/local/lib/python3.6/dist-packages (from packaging->transformers) (2.4.7)\n","Requirement already satisfied: six in /usr/local/lib/python3.6/dist-packages (from packaging->transformers) (1.15.0)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.6/dist-packages (from requests->transformers) (2.10)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.6/dist-packages (from requests->transformers) (1.24.3)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.6/dist-packages (from requests->transformers) (3.0.4)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.6/dist-packages (from requests->transformers) (2020.6.20)\n","Requirement already satisfied: click in /usr/local/lib/python3.6/dist-packages (from sacremoses->transformers) (7.1.2)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.6/dist-packages (from sacremoses->transformers) (0.16.0)\n","Building wheels for collected packages: sacremoses\n","  Building wheel for sacremoses (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for sacremoses: filename=sacremoses-0.0.43-cp36-none-any.whl size=893257 sha256=4f3a7d8944ce1790894210512121ed0ef08e74c4d47b64874f29fd8fb69ee659\n","  Stored in directory: /root/.cache/pip/wheels/29/3c/fd/7ce5c3f0666dab31a50123635e6fb5e19ceb42ce38d4e58f45\n","Successfully built sacremoses\n","Installing collected packages: sentencepiece, tokenizers, sacremoses, transformers\n","Successfully installed sacremoses-0.0.43 sentencepiece-0.1.91 tokenizers-0.8.1rc1 transformers-3.0.2\n","Collecting mecab-python3==0.996.5\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/18/49/b55a839a77189042960bf96490640c44816073f917d489acbc5d79fa5cc3/mecab_python3-0.996.5-cp36-cp36m-manylinux2010_x86_64.whl (17.1MB)\n","\u001b[K     |████████████████████████████████| 17.1MB 242kB/s \n","\u001b[?25hInstalling collected packages: mecab-python3\n","Successfully installed mecab-python3-0.996.5\n","Collecting googletrans\n","  Downloading https://files.pythonhosted.org/packages/71/3a/3b19effdd4c03958b90f40fe01c93de6d5280e03843cc5adf6956bfc9512/googletrans-3.0.0.tar.gz\n","Collecting httpx==0.13.3\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/54/b4/698b284c6aed4d7c2b4fe3ba5df1fcf6093612423797e76fbb24890dd22f/httpx-0.13.3-py3-none-any.whl (55kB)\n","\u001b[K     |████████████████████████████████| 61kB 4.5MB/s \n","\u001b[?25hCollecting sniffio\n","  Downloading https://files.pythonhosted.org/packages/b3/82/4bd4b7d9c0d1dc0fbfbc2a1e00138e7f3ab85bc239358fe9b78aa2ab586d/sniffio-1.1.0-py3-none-any.whl\n","Requirement already satisfied: chardet==3.* in /usr/local/lib/python3.6/dist-packages (from httpx==0.13.3->googletrans) (3.0.4)\n","Collecting rfc3986<2,>=1.3\n","  Downloading https://files.pythonhosted.org/packages/78/be/7b8b99fd74ff5684225f50dd0e865393d2265656ef3b4ba9eaaaffe622b8/rfc3986-1.4.0-py2.py3-none-any.whl\n","Collecting hstspreload\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/90/df/c9c1b75d2c0b6154b00576bb6db17aef9c306c5c56a41712ccad637a6763/hstspreload-2020.8.25-py3-none-any.whl (947kB)\n","\u001b[K     |████████████████████████████████| 952kB 15.2MB/s \n","\u001b[?25hCollecting httpcore==0.9.*\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/dd/d5/e4ff9318693ac6101a2095e580908b591838c6f33df8d3ee8dd953ba96a8/httpcore-0.9.1-py3-none-any.whl (42kB)\n","\u001b[K     |████████████████████████████████| 51kB 4.7MB/s \n","\u001b[?25hRequirement already satisfied: certifi in /usr/local/lib/python3.6/dist-packages (from httpx==0.13.3->googletrans) (2020.6.20)\n","Requirement already satisfied: idna==2.* in /usr/local/lib/python3.6/dist-packages (from httpx==0.13.3->googletrans) (2.10)\n","Collecting contextvars>=2.1; python_version < \"3.7\"\n","  Downloading https://files.pythonhosted.org/packages/83/96/55b82d9f13763be9d672622e1b8106c85acb83edd7cc2fa5bc67cd9877e9/contextvars-2.4.tar.gz\n","Collecting h2==3.*\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/25/de/da019bcc539eeab02f6d45836f23858ac467f584bfec7a526ef200242afe/h2-3.2.0-py2.py3-none-any.whl (65kB)\n","\u001b[K     |████████████████████████████████| 71kB 5.6MB/s \n","\u001b[?25hCollecting h11<0.10,>=0.8\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/5a/fd/3dad730b0f95e78aeeb742f96fa7bbecbdd56a58e405d3da440d5bfb90c6/h11-0.9.0-py2.py3-none-any.whl (53kB)\n","\u001b[K     |████████████████████████████████| 61kB 5.3MB/s \n","\u001b[?25hCollecting immutables>=0.9\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/99/e0/ea6fd4697120327d26773b5a84853f897a68e33d3f9376b00a8ff96e4f63/immutables-0.14-cp36-cp36m-manylinux1_x86_64.whl (98kB)\n","\u001b[K     |████████████████████████████████| 102kB 7.8MB/s \n","\u001b[?25hCollecting hpack<4,>=3.0\n","  Downloading https://files.pythonhosted.org/packages/8a/cc/e53517f4a1e13f74776ca93271caef378dadec14d71c61c949d759d3db69/hpack-3.0.0-py2.py3-none-any.whl\n","Collecting hyperframe<6,>=5.2.0\n","  Downloading https://files.pythonhosted.org/packages/19/0c/bf88182bcb5dce3094e2f3e4fe20db28a9928cb7bd5b08024030e4b140db/hyperframe-5.2.0-py2.py3-none-any.whl\n","Building wheels for collected packages: googletrans, contextvars\n","  Building wheel for googletrans (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for googletrans: filename=googletrans-3.0.0-cp36-none-any.whl size=15736 sha256=3c8ad027ee74d53f9fc3f0420b2492031deb8086cb247796dc89acf93a7c4782\n","  Stored in directory: /root/.cache/pip/wheels/28/1a/a7/eaf4d7a3417a0c65796c547cff4deb6d79c7d14c2abd29273e\n","  Building wheel for contextvars (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for contextvars: filename=contextvars-2.4-cp36-none-any.whl size=7666 sha256=58c5bc80fc5db3bc581137e5ff962ef246d382801b3db47eb9ca0734105a1c26\n","  Stored in directory: /root/.cache/pip/wheels/a5/7d/68/1ebae2668bda2228686e3c1cf16f2c2384cea6e9334ad5f6de\n","Successfully built googletrans contextvars\n","Installing collected packages: immutables, contextvars, sniffio, rfc3986, hstspreload, hpack, hyperframe, h2, h11, httpcore, httpx, googletrans\n","Successfully installed contextvars-2.4 googletrans-3.0.0 h11-0.9.0 h2-3.2.0 hpack-3.0.0 hstspreload-2020.8.25 httpcore-0.9.1 httpx-0.13.3 hyperframe-5.2.0 immutables-0.14 rfc3986-1.4.0 sniffio-1.1.0\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"3fBXGO1e3PB0","colab_type":"text"},"source":["## Tokenizer\n","Tokenizerは、文章を単語ごとに分割(分かち書き)し、数字を割り当てます。\n","\n","単語に分解し、その単語を**一意の数字**に置き換えることで、行列演算による機械学習を可能としている。\n","\n"]},{"cell_type":"code","metadata":{"id":"Pzt_9s6F4Psl","colab_type":"code","cellView":"both","colab":{"base_uri":"https://localhost:8080/","height":198,"referenced_widgets":["57430c56fab7411baafa1b6307dc4d84","288d9358674d4379acbff7e67147a520","7521a87253d64791903c9b89d5f04872","79aa097e43b64c51a8f6607d28b9d978","27b64c5c05e1467baebf84cf27c330dc","a212701487724a248d38f71493308a75","6978969786bd4849814a11eaf46973d4","423e2b50c0464e418d626a2528d4f5a1","5b1471b19d8b40669775afb21d1eef0d","e0ea8f9e210d429596a9aeae5ee57f38","ff50f2d913704bcc9598066a81235c39","cfe5a2cb60c546a7a7648a638eb1bd01","d7c7cdf58fef4baa8124359223cae4da","dfbb07819859406cb2e95190c6f6ec91","2f44373a84de424eb4ef60be1e6df125","782a46154b414eedb52198333a38c690","e6ab2b2762484a8e8ba75324283c2bf4","89b0ba1a5f474a329b83fa45f25025a4","4f8e2d2f5637457abd330b5f88bcb256","c44ade2594804b53a1ab3dfb323ac8c0","7e2217cca4f6478fa884acb68644d4c7","8e4664d73d1041a18421a7be5b521277","9e5c4e3d214a4608ad6b2ef23199e24b","d5a59a3aa1d84157a1b5970e85587bba"]},"executionInfo":{"status":"ok","timestamp":1598420188926,"user_tz":-540,"elapsed":4936,"user":{"displayName":"Takeshi Yanagimoto","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiR4MKhXgeH9jEFGCkO4J8eljwD3IuSWpo5X3QE=s64","userId":"03972123812053985591"}},"outputId":"2eeea337-0a40-4923-a5e1-d2a2649b9e42"},"source":["#@title 分かち書きしたい文章を以下に入力。 { run: \"auto\" }\n","tokenizer = BertJapaneseTokenizer.from_pretrained('daigo/bert-base-japanese-sentiment') #モデル読み込み\n","sentence = '今日の天気は晴れ。' #@param {type:\"string\"}\n","tokenized_sentence = tokenizer.tokenize(sentence,)\n","print(tokenized_sentence)\n","encoded_sentence = tokenizer.encode(sentence)\n","print(encoded_sentence)"],"execution_count":2,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"57430c56fab7411baafa1b6307dc4d84","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=257706.0, style=ProgressStyle(descripti…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"5b1471b19d8b40669775afb21d1eef0d","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=112.0, style=ProgressStyle(description_…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"e6ab2b2762484a8e8ba75324283c2bf4","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=111.0, style=ProgressStyle(description_…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","['今日', 'の', '天気', 'は', '晴れ', '。']\n","[2, 3246, 5, 11385, 9, 16577, 8, 3]\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"iQE3yC1G1jWG","colab_type":"text"},"source":["<補足>　<font size=-1>※CLSは入力の先頭、SEPは分の区切りを表すトークン※\n","\n","サンプル文章：**今日の天気は晴れ**\n","\n","　↓（分かち書きの結果）↓\n","<table border=\"1\" align=\"left\">\n","<tr><th>[CLS]</th><th>今日</th><th>の</th><th>天気</th><th>は</th><th>晴れ</th><th>。</th><th>[SEP]</th></tr>\n","<tr><th>2</th><th>3246</th><th>5</th><th>11385</th><th>9</th><th>16577</th><th>8</th><th>3</th></tr>\n","</table>\n"]},{"cell_type":"markdown","metadata":{"id":"cgb8AevoBXxQ","colab_type":"text"},"source":["\n","\n","---\n","\n"]},{"cell_type":"markdown","metadata":{"id":"nVWMhTPzBIOp","colab_type":"text"},"source":["# BERTを使ってみる\n","*   感情分析\n","*   単語推定\n","*   文章要約\n","\n","※間に合わなかったが、その他に質問回答（質問すると回答を予測する）や文章作成（文章を与えると、勝手に色々文章を作ってくれる）など、世の中にはいろいろな物があります。\n"]},{"cell_type":"markdown","metadata":{"id":"vfx57QgNKpbF","colab_type":"text"},"source":["## 感情分析\n","文章がポジティブなのかネガティブなのかを判定（感情分析）する。"]},{"cell_type":"code","metadata":{"id":"tBDxEkpxKHwV","colab_type":"code","cellView":"both","colab":{"base_uri":"https://localhost:8080/","height":132,"referenced_widgets":["d9f2121bfa764125a70409d80dd3a93f","d63f08075f00424fac073f620b547bd7","f15ceba5f8de4f248895d99e79f8747a","35a8fa9a61304ba78e9407b3c4235b71","7e80f3df53fe4cdabd1dc869ff428a92","9a7f0193b8f840a6991bbf1c4d61677d","3e77529cb6d0416da2828715cfbb9d85","d0347037bb0c4987921ec0896b8e23ed","647ea42ca6ef46e2b7661ccce86b5704","e5fc6a284fad43fcbbea8626da7a0862","781cbd860bb14df091cfa52b47711bf4","9bb2633cc4da45d2aceb5e5d6e090130","437d50ea4719411d8a23a0ca3502d514","e5bf508f942c4f98a9ee4545e8f376f0","ba41a8c59f264995b94f1aab83cb7cde","1e1a74c8b3ef4a009aaed5f06906bf06"]},"executionInfo":{"status":"ok","timestamp":1598420245398,"user_tz":-540,"elapsed":24636,"user":{"displayName":"Takeshi Yanagimoto","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiR4MKhXgeH9jEFGCkO4J8eljwD3IuSWpo5X3QE=s64","userId":"03972123812053985591"}},"outputId":"691f0245-c586-446c-c790-e7d791ca6011"},"source":["sentence = \"雨が降っていた。\"\n","#sentence = \"雨が降っていたが、午後から晴れた。\"\n","\n","tokenizer = AutoTokenizer.from_pretrained(\"daigo/bert-base-japanese-sentiment\")  # 学習済みモデル読み込み\n","model = AutoModelForSequenceClassification.from_pretrained(\"daigo/bert-base-japanese-sentiment\")  # 学習済みモデル読み込み\n","\n","#TaskのParameterにsentiment-analysis(感情分析)を設定\n","print(pipeline(\"sentiment-analysis\",model=\"daigo/bert-base-japanese-sentiment\",tokenizer=\"daigo/bert-base-japanese-sentiment\")(sentence))\n","\n","#tokenized_sentence = tokenizer.tokenize(sentence)\n","#print(tokenized_sentence)\n","#encoded_sentence = tokenizer.encode(sentence)\n","#print(encoded_sentence)"],"execution_count":3,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"d9f2121bfa764125a70409d80dd3a93f","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=1271.0, style=ProgressStyle(description…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"647ea42ca6ef46e2b7661ccce86b5704","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=442523795.0, style=ProgressStyle(descri…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","[{'label': 'ネガティブ', 'score': 0.5392199754714966}]\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"_z2uhTIeVTBp","colab_type":"text"},"source":["<font size=-1>**＜補足＞**\n","\n","<font size=-1>「雨が降っていた」はネガティブだが、「午後から晴れた」加えるとポジティブに変わる。文脈を理解しながら判定していることが伺える。"]},{"cell_type":"markdown","metadata":{"id":"8kOXdDKHNxet","colab_type":"text"},"source":["## 単語推定\n","文章の一部をマスクして、マスクした部分の言葉を推定する。"]},{"cell_type":"code","metadata":{"id":"9avEFdmrxF7J","colab_type":"code","colab":{}},"source":["tokenizer = BertJapaneseTokenizer.from_pretrained('cl-tohoku/bert-base-japanese-char-whole-word-masking')  # 学習済みモデルの読み込み\n","model = BertForMaskedLM.from_pretrained('cl-tohoku/bert-base-japanese-char-whole-word-masking')  # 学習済みモデルの読み込み\n","\n","#TaskのParameterにfill-mask(単語推定)を設定\n","nlp = pipeline(\"fill-mask\",model='cl-tohoku/bert-base-japanese-whole-word-masking',tokenizer='cl-tohoku/bert-base-japanese-whole-word-masking')\n","#nlp(f\"今日はテレビで{nlp.tokenizer.mask_token}の試合を見る。\")\n","nlp(f\"学生時代はバレーボールをしていた。今日はテレビで{nlp.tokenizer.mask_token}の試合を見る。\")"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"BEZZBReonWi3","colab_type":"text"},"source":["<font size=-1>**＜補足＞**\n","\n","<font size=-1>「今日はテレビで[MASK]の試合をみる」の前に<font color=red>文章を付け足すことで、推定する言葉が変わってくる。<font color=black>このように、文脈を理解しながら推定していることが伺える。\n"]},{"cell_type":"markdown","metadata":{"id":"7ZWs5PoRQGLF","colab_type":"text"},"source":["##文章要約\n","文章を要約する。\n","\n","<font size=-1><b>使うモデルが日本語対応していないため、日本語を英語翻訳した上で文章要約し、要約結果の英文を日本語翻訳する。<font color=red>（なんちゃって文書要約・・・）\n"]},{"cell_type":"markdown","metadata":{"id":"Q3aUB_9zoEHM","colab_type":"text"},"source":["【今回、入力としたサンプル文】\n","\n","<font size=-1><font color=blue>ＦＢＩと国土安全保障省の共同声明によると、ＦＢＩは中国系ハッカー集団による米研究機関などへのサイバー攻撃の調査を進めている。これまでの調査で、ネットワークを通じ、ワクチンや治療法、検査に関わる知的財産や関連情報を特定し、不正に取得しようとする動きが確認された。"]},{"cell_type":"code","metadata":{"id":"FzVLFv4-qyAa","colab_type":"code","cellView":"both","colab":{"base_uri":"https://localhost:8080/","height":71},"executionInfo":{"status":"ok","timestamp":1598420560823,"user_tz":-540,"elapsed":1116,"user":{"displayName":"Takeshi Yanagimoto","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiR4MKhXgeH9jEFGCkO4J8eljwD3IuSWpo5X3QE=s64","userId":"03972123812053985591"}},"outputId":"0413ab16-e671-4d45-99f9-b526868954e8"},"source":["sentence = \"ＦＢＩと国土安全保障省の共同声明によると、ＦＢＩは中国系ハッカー集団による米研究機関などへのサイバー攻撃の調査を進めている。これまでの調査で、ネットワークを通じ、ワクチンや治療法、検査に関わる知的財産や関連情報を特定し、不正に取得しようとする動きが確認された。\"\n","\n","from googletrans import Translator\n","translator = Translator()\n","trans_en = translator.translate(sentence)\n","print(\"-----要約モデルに流し込む英文を用意（googleで英訳）-----\")\n","print(trans_en.text)"],"execution_count":9,"outputs":[{"output_type":"stream","text":["-----要約モデルに流し込む英文を用意（googleで英訳）-----\n","According to a joint statement between the FBI and the Department of Homeland Security, the FBI is investigating cyber attacks on US research institutions by Chinese hacker groups. Previous studies have confirmed a move to identify and illegally acquire intellectual property and related information related to vaccines, treatments, and tests through networks.\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"4E8I-xzatp5f","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":267,"referenced_widgets":["389495e494ee4a09953e95f8acbf84b4","35ddbd3388bb438a8b64e20e2c70b0b2","2947647d5fa149f5933f4b3d77d6e117","62d9a547830a4453bfb2386f989b568b","5a86ac71b20f40a08fcfc3705eac469f","d6a4f72e063244ff818b73216a4930bf","9e9b5c03461c4f28ae48c091e7f2ec39","07a1c206185a4f069070d039953ed7cc","b6e2c254e3ce4e51b38df803af9e7116","f7e4bfaa4b954daf8059d1834ce32bf7","8ea869038caf4852b374aa2765f055fd","317e7c1df5d244c79fede70d2497fef3","1ec95f6bf172476c8673085bdea8677e","1a49dccaa6df449ab9f0459f5f53a7ec","1f4eb931ce564cee830d7f279f54d2fe","62fd16ced62a4d56af40c7e10027379e","df7a481584cb4f0fa0cc5017576624ed","41610bc3fbe647b48ac4ea17c2c375c9","ee06f7f066b34b1493d491ab7fa2f77d","7084b3c2b85b464eb1940967c0f3b1f2","ea8ee6b15159420992658b0bb018b6ff","2e2e4bfaf433478898ac1cccd58c9381","650dd97d910d4000a80edd875883aacf","f44aedcf2b2f4e598e27ee329af0452a","0e890bf4932342a38a4e1844394c5268","4f7777619be84e47a53d521e29a4c2cd","a9f9ffe1d4464cbf972617b1f0d734ed","b54271936c80419d88f178b4cf115593","e4d6814f79084a689b96af79780c1fa3","0d94b23f062f4633b24a0f9a5e2460e4","c9ae004e0fe14865a4ee1e9f8a1dad04","a39fc240458142d78decb9494a71bbd6"]},"executionInfo":{"status":"ok","timestamp":1598420733579,"user_tz":-540,"elapsed":55021,"user":{"displayName":"Takeshi Yanagimoto","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiR4MKhXgeH9jEFGCkO4J8eljwD3IuSWpo5X3QE=s64","userId":"03972123812053985591"}},"outputId":"a6afd1f5-9317-4f0a-8931-4d8f3bd639b1"},"source":["text = trans_en.text\n","#TaskのParameterにsummarization(要約)を設定\n","summarizer = pipeline(\"summarization\",model=\"facebook/bart-large-cnn\")\n","summary=summarizer(text, min_length=5, max_length=30)"],"execution_count":11,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"389495e494ee4a09953e95f8acbf84b4","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=1343.0, style=ProgressStyle(description…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"b6e2c254e3ce4e51b38df803af9e7116","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=898823.0, style=ProgressStyle(descripti…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"df7a481584cb4f0fa0cc5017576624ed","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=456318.0, style=ProgressStyle(descripti…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"0e890bf4932342a38a4e1844394c5268","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=1625270765.0, style=ProgressStyle(descr…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"stream","text":["Some weights of BartForConditionalGeneration were not initialized from the model checkpoint at facebook/bart-large-cnn and are newly initialized: ['final_logits_bias']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n"],"name":"stderr"}]},{"cell_type":"code","metadata":{"id":"fbKLVbrR7es_","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":71},"executionInfo":{"status":"ok","timestamp":1598420738072,"user_tz":-540,"elapsed":947,"user":{"displayName":"Takeshi Yanagimoto","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiR4MKhXgeH9jEFGCkO4J8eljwD3IuSWpo5X3QE=s64","userId":"03972123812053985591"}},"outputId":"585e73a1-40d6-49ff-d621-d86860ac23e6"},"source":["print(\"-----要約結果の確認(取りあえず英文のまま)----\")\n","import json\n","data =json.dumps(summary[0]['summary_text'])\n","print(data)"],"execution_count":12,"outputs":[{"output_type":"stream","text":["-----要約結果の確認(取りあえず英文のまま)----\n","\"The FBI is investigating cyber attacks on US research institutions by Chinese hacker groups. Previous studies have confirmed a move to identify and illegally acquire intellectual\"\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"C6_UuCdBBASB","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":71},"executionInfo":{"status":"ok","timestamp":1598420742147,"user_tz":-540,"elapsed":866,"user":{"displayName":"Takeshi Yanagimoto","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiR4MKhXgeH9jEFGCkO4J8eljwD3IuSWpo5X3QE=s64","userId":"03972123812053985591"}},"outputId":"2d273390-d68d-44e7-d32c-276f08a259f1"},"source":["summary_ja = translator.translate(data, dest='ja')\n","print(\"-----要約結果(英文)をgoogleで和訳----\")\n","print(summary_ja.text)"],"execution_count":13,"outputs":[{"output_type":"stream","text":["-----要約結果(英文)をgoogleで和訳----\n","「FBIは中国のハッカーグループによる米国の研究機関へのサイバー攻撃を調査しています。以前の調査では、知的財産を特定し、違法に取得する動きが確認されています。」\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"b-zbB_dMVye9","colab_type":"text"},"source":["<font size=-1>**＜補足＞**\n","\n","<font size=-1>google translatorの精度が良い為、そこそこ使えるような気がする。\n"]},{"cell_type":"markdown","metadata":{"id":"llGUOND_ntMW","colab_type":"text"},"source":["## 【ポイント】**huggingface**  <img src=\"https://huggingface.co/front/assets/huggingface_mask.svg\" width=50 height=50>\n","数多くのTransformer系モデルを公開しているサイトです。事前学習されたモデルもここから入手できます。\n","\n","※学習済みのモデルは、https://huggingface.co/models から入手できます。\"japan\"などのキーワードで検索すると日本語の対応モデルを探すことが出来ます。\n"]}]}